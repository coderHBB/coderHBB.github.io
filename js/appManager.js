var grouts = [{
        "id": 1,
        "colorName": "White",
        "subName": "Aquastatic ",
        "value": "#f7f3ef",
        "className": "CE40"
    },
    {
        "id": 39,
        "colorName": "Pergamon",
        "subName": "Aquastatic ",
        "value": "#e8dfd8",
        "className": "CE40"
    },
    {
        "id": 3,
        "colorName": "Carrara",
        "subName": "Aquastatic ",
        "value": "#e2e0de",
        "className": "CE40"
    },
    {
        "id": 4,
        "colorName": "Silver",
        "subName": "Aquastatic ",
        "value": "#d8d0c7",
        "className": "CE40"
    },
    {
        "id": 10,
        "colorName": "Manhattan",
        "subName": "Aquastatic ",
        "value": "#968f86",
        "className": "CE40"
    },
    {
        "id": 7,
        "colorName": "Gray",
        "subName": "Aquastatic ",
        "value": "#bcaa99",
        "className": "CE40"
    },
    {
        "id": 12,
        "colorName": "Cementgray",
        "subName": "Aquastatic ",
        "value": "#aaa49c",
        "className": "CE40"
    },
    {
        "id": 13,
        "colorName": "Antracite",
        "subName": "Aquastatic ",
        "value": "#968f86",
        "className": "CE40"
    },
    {
        "id": 16,
        "colorName": "Graphite",
        "subName": "Aquastatic ",
        "value": "#514f4e",
        "className": "CE40"
    },
    {
        "id": 18,
        "colorName": "Coal",
        "subName": "Aquastatic ",
        "value": "#2d2a28",
        "className": "CE40"
    },
    {
        "id": 79,
        "colorName": "Crocus",
        "subName": "Aquastatic ",
        "value": "#b6c8d1",
        "className": "CE40"
    },
    {
        "id": 80,
        "colorName": "Sky",
        "subName": "Aquastatic ",
        "value": "#aedeeb",
        "className": "CE40"
    },
    {
        "id": 64,
        "colorName": "Mint",
        "subName": "Aquastatic ",
        "value": "#b5dcc7",
        "className": "CE40"
    },
    {
        "id": 67,
        "colorName": "Kiwi",
        "subName": "Aquastatic ",
        "value": "#96be9f",
        "className": "CE40"
    },
    {
        "id": 90,
        "colorName": "Lila",
        "subName": "Aquastatic ",
        "value": "#d2cce8",
        "className": "CE40"
    },
    {
        "id": 88,
        "colorName": "Ocean",
        "subName": "Aquastatic ",
        "value": "#64760",
        "className": "CE40"
    },
    {
        "id": 70,
        "colorName": "Amazon",
        "subName": "Aquastatic ",
        "value": "#296b66",
        "className": "CE40"
    },
    {
        "id": 40,
        "colorName": "Jasmine",
        "subName": "Aquastatic ",
        "value": "#e8d9c7",
        "className": "CE40"
    },
    {
        "id": 22,
        "colorName": "Melba",
        "subName": "Aquastatic ",
        "value": "#fec289",
        "className": "CE40"
    },
    {
        "id": 41,
        "colorName": "Natura",
        "subName": "Aquastatic ",
        "value": "#f6d3b8",
        "className": "CE40"
    },
    {
        "id": 43,
        "colorName": "Bahama",
        "subName": "Aquastatic ",
        "value": "#c4a68d",
        "className": "CE40"
    },
    {
        "id": 46,
        "colorName": "Caramel",
        "subName": "Aquastatic ",
        "value": "#c99475",
        "className": "CE40"
    },
    {
        "id": 44,
        "colorName": "Toffi",
        "subName": "Aquastatic ",
        "value": "#cb9a74",
        "className": "CE40"
    },
    {
        "id": 47,
        "colorName": "Siena",
        "subName": "Aquastatic ",
        "value": "#a06b56",
        "className": "CE40"
    },
    {
        "id": 52,
        "colorName": "Cocoa",
        "subName": "Aquastatic ",
        "value": "#816058",
        "className": "CE40"
    },
    {
        "id": 55,
        "colorName": "Terra",
        "subName": "Aquastatic ",
        "value": "#a26854",
        "className": "CE40"
    },
    {
        "id": 58,
        "colorName": "Chocolate",
        "subName": "Aquastatic ",
        "value": "#b85b3d",
        "className": "CE40"
    },
    {
        "id": 31,
        "colorName": "Rosa",
        "subName": "Aquastatic ",
        "value": "#fee0d4",
        "className": "CE40"
    },
    {
        "id": 34,
        "colorName": "Pink",
        "subName": "Aquastatic ",
        "value": "#ed96a7",
        "className": "CE40"
    },
    {
        "id": 28,
        "colorName": "Cream",
        "subName": "Aquastatic ",
        "value": "#f6d3b8",
        "className": "CE40"
    },
    {
        "id": 25,
        "colorName": "Sahara",
        "subName": "Aquastatic ",
        "value": "#c4a68d",
        "className": "CE40"
    },
    {
        "id": 49,
        "colorName": "Clinker",
        "subName": "Aquastatic ",
        "value": "#a3665a",
        "className": "CE40"
    },
    {
        "id": 37,
        "colorName": "Chili",
        "subName": "Aquastatic ",
        "value": "#e20c37",
        "className": "CE40"
    },
    {
        "id": 102,
        "colorName": "Marble White",
        "subName": "Trend Collection",
        "value": "#ffffff",
        "className": "CE40"
    },
    {
        "id": 111,
        "colorName": "Iron Grey",
        "subName": "Trend Collection",
        "value": "#4f6369",
        "className": "CE40"
    },
    {
        "id": 145,
        "colorName": "Almondtree brown",
        "subName": "Trend Collection",
        "value": "#846453",
        "className": "CE40"
    },
    {
        "id": 191,
        "colorName": "Brown",
        "subName": "Trend Collection",
        "value": "#97442d",
        "className": "CE40"
    },
    {
        "id": 195,
        "colorName": "Platinum",
        "subName": "Trend Collection",
        "value": "#514f4b",
        "className": "CE40"
    },
    {
        "id": 199,
        "colorName": "Luminous Light",
        "subName": "Trend Collection",
        "value": "#f89842",
        "className": "CE40"
    },
    {
        "id": 801,
        "colorName": "Crystal White ",
        "subName": "UltraEpoxy Premium ",
        "value": "#F0F0EC",
        "className": "CE89"
    },
    {
        "id": 809,
        "colorName": "Concrete Gray",
        "subName": "UltraEpoxy Premium ",
        "value": "#B1B3B3",
        "className": "CE89"
    },
    {
        "id": 807,
        "colorName": "Pearl Gray",
        "subName": "UltraEpoxy Premium ",
        "value": "#BFB8AF",
        "className": "CE89"
    },
    {
        "id": 814,
        "colorName": "Natural Quartz",
        "subName": "UltraEpoxy Premium ",
        "value": "#8C857B",
        "className": "CE89"
    },
    {
        "id": 817,
        "colorName": "Solid Slate",
        "subName": "UltraEpoxy Premium ",
        "value": "#7C878E",
        "className": "CE89"
    },
    {
        "id": 859,
        "colorName": "Smoked Topaz",
        "subName": "UltraEpoxy Premium ",
        "value": "#946037",
        "className": "CE89"
    },
    {
        "id": 844,
        "colorName": "Toffi",
        "subName": "UltraEpoxy Premium ",
        "value": "#E0C09F",
        "className": "CE89"
    },
    {
        "id": 840,
        "colorName": "Jasmine",
        "subName": "UltraEpoxy Premium ",
        "value": "#DDCBA4",
        "className": "CE89"
    },
    {
        "id": 881,
        "colorName": "Moonstone Blue",
        "subName": "UltraEpoxy Premium ",
        "value": "#B9D9EB",
        "className": "CE89"
    },
    {
        "id": 887,
        "colorName": "Saphire Blue",
        "subName": "UltraEpoxy Premium ",
        "value": "#1D4F91",
        "className": "CE89"
    },
    {
        "id": 871,
        "colorName": "Emerald Green",
        "subName": "UltraEpoxy Premium ",
        "value": "#285C4D",
        "className": "CE89"
    },
    {
        "id": 838,
        "colorName": "Ruby Red",
        "subName": "UltraEpoxy Premium ",
        "value": "#BA0C2F",
        "className": "CE89"
    },
    {
        "id": 800,
        "colorName": "Transparent",
        "subName": "UltraEpoxy Premium ",
        "value": "#F4ECC2",
        "className": "CE89"
    },
    {
        "id": 701,
        "colorName": "Crystal White ",
        "subName": "UltraEpoxy Industria",
        "value": "#F0F0EC",
        "className": "CE79"
    },
    {
        "id": 710,
        "colorName": "Light Gray",
        "subName": "UltraEpoxy Industria",
        "value": "#C1C6C8",
        "className": "CE79"
    },
    {
        "id": 716,
        "colorName": "Graphite",
        "subName": "UltraEpoxy Industria",
        "value": "#25282A",
        "className": "CE79"
    },
    {
        "id": 743,
        "colorName": "Bahama",
        "subName": "UltraEpoxy Industria",
        "value": "#DBC8B6",
        "className": "CE79"
    },
    {
        "id": 723,
        "colorName": "Sandstone",
        "subName": "UltraEpoxy Industria",
        "value": "#DDCBA4",
        "className": "CE79"
    },
    {
        "id": 742,
        "colorName": "Alabaster",
        "subName": "UltraEpoxy Industria",
        "value": "#D6D2C4",
        "className": "CE79"
    },
];

function initializeApp() {
//    loadFloorGrouts("Kitchen");
//    loadWallGrouts();
//    loadWallTiles("kitchen");
//    loadFloorTiles("bath01");
}

// Function to load the grouts
function loadFloorGrouts(roomName)
{
    var floorGroutMenu = document.getElementById('floor-btn-group');

    for (i = 0; i < grouts.length; i++)
    {
        console.log("creating");
        var btn = document.createElement("BUTTON"); // Create a <button> element
        btn.innerHTML = grouts[i].colorName; // Insert text
        btn.classList.add('btn')
        btn.classList.add('floor-grout-btn')
        btn.style.backgroundColor = grouts[i].value;
        if (i == 0) {
            btn.classList.add('active');
            changeFloorMenuHeaderName(grouts[0].colorName);
        }
        var buttonClass = document.createElement("DIV");
        buttonClass.innerHTML = grouts[i].className;
        buttonClass.classList.add('button-description');
        btn.appendChild(buttonClass);
        btn.onclick = function ()
        {
            changeFloorGrout(this);
            changeFloorMenuHeaderName(this.innerHTML);
        }
        floorGroutMenu.appendChild(btn);
    }
}

function loadWallGrouts(roomName)
{
    var wallGroutMenu = document.getElementById('wall-grout-btn-group');

    while (wallGroutMenu.firstChild)
    {
        console.log("deleting");
        wallGroutMenu.removeChild(wallGroutMenu.firstChild);
    }

    if(roomName != "Exterior01")
    {
        for (i = 0; i < grouts.length; i++)
        {
            var btn = document.createElement("BUTTON"); // Create a <button> element
            btn.innerHTML = grouts[i].colorName; // Insert text
            btn.classList.add('btn')
            btn.classList.add('wall-grout-btn')
            btn.style.backgroundColor = grouts[i].value;
            if (i == 0) {
                btn.classList.add('active');
                changeWallMenuHeaderName(grouts[0].colorName);
            }
            var buttonClass = document.createElement("DIV");
            buttonClass.innerHTML = grouts[i].className;
            buttonClass.classList.add('button-description');
            btn.appendChild(buttonClass);
            btn.onclick = function ()
            {
                changeWallGrout(this);
                changeWallMenuHeaderName(this.innerHTML);
            }
            wallGroutMenu.appendChild(btn);
        }
    }
}

function loadWallTiles(room)
{
    var wallTileMenu = document.getElementById('wall-tile-btn-group');

    while (wallTileMenu.firstChild)
    {
        wallTileMenu.removeChild(wallTileMenu.firstChild);
    }

    if(roomName != "Exterior01")
    {
        for (i = 0; i < 5; i++)
        {
            var btn = document.createElement("BUTTON"); // Create a <button> element
            btn.classList.add('btn')
            btn.classList.add('wall-tile-btn')
            btn.setAttribute("tileName", "WallTile"+i)
            btn.setAttribute("roomName", room)
            btn.style.backgroundImage = "url('src/thumbnails/wall_tiles/" + roomName + "/WallTile" + i + ".jpg')";
            if (i == 0)
            {
                btn.classList.add('active');
                // console.log(grouts[0].colorName);
                changeWallTileMenuHeaderName(grouts[0].colorName);
            }
            btn.onclick = function ()
            {
                changeWallTile(this);
                changeWallTileMenuHeaderName(this.innerHTML);
            }
            wallTileMenu.appendChild(btn);
        }
    }
}

/*function loadFloorTiles() {
    var floorTileMenu = document.getElementById('floor-tile-btn-group');
    for (i = 0; i < 10; i++) {
        var btn = document.createElement("BUTTON"); // Create a <button> element
        btn.innerHTML = grouts[i].colorName; // Insert text
        btn.classList.add('btn')
        btn.classList.add('floor-tile-btn')
        btn.style.backgroundColor = grouts[i].value;
        if (i == 0) {
            btn.classList.add('active');
            // console.log(grouts[0].colorName);
            changeFloorTileMenuHeaderName(grouts[0].colorName);
        }
        floorTileMenu.appendChild(btn);
    }

    var buttons = floorTileMenu.getElementsByTagName("BUTTON");
    for (i = 0; i < 10; i++) {
        var btn = buttons[i];
        buttons[i].onclick = function () {
            changeFloorTile(this);
            changeFloorTileMenuHeaderName(this.innerHTML);
        }
    }

    // changeFloorGrout(floorGroutMenu.firstChild);
}*/

function loadFloorTiles(room) {
    console.log(room)
    var floorTileMenu = document.getElementById('floor-tile-btn-group');
    while (floorTileMenu.firstChild)
    {
        floorTileMenu.removeChild(floorTileMenu.firstChild);
    }
    for (i = 0; i < 5; i++) {
        var btn = document.createElement("BUTTON"); // Create a <button> element
        /*btn.innerHTML = grouts[i].colorName;*/ // Insert text
        btn.classList.add('btn')
        btn.classList.add('floor-tile-btn')
        btn.setAttribute("tileName", "FloorTile"+i)
        btn.setAttribute("roomName", room)
        btn.style.backgroundImage = "url('src/thumbnails/floor_tiles/" + roomName + "/FloorTile" + i + ".jpg')";
        //btn.style.backgroundColor = grouts[i].value;
//        if(room == "Bath01")
//            btn.style.backgroundImage = "url('src/img/thumbnails/bath_floorTile" + i + ".jpg')";
//        else
//            btn.style.backgroundImage = "url('src/img/thumbnails/floorTile" + i + ".jpg')";
        if (i == 0) {
            btn.classList.add('active');
            // console.log(grouts[0].colorName);
            changeFloorTileMenuHeaderName(grouts[0].colorName);
        }
        floorTileMenu.appendChild(btn);
    }

    var buttons = floorTileMenu.getElementsByTagName("BUTTON");
    for (i = 0; i < 5; i++) {
        var btn = buttons[i];
        buttons[i].onclick = function () {
            changeFloorTile(room, this);
            changeFloorTileMenuHeaderName(this.innerHTML);
        }
    }

    // changeFloorGrout(floorGroutMenu.firstChild);
}

function changeFloorGrout(currentButton) {
    var roomButtons = document.getElementsByClassName("floor-grout-btn");
    for (i = 0; i < roomButtons.length; i++) {
        roomButtons[i].classList.remove("active");
    }
    currentButton.classList.add('active');

    var floorGroutCanvas = document.getElementById("floorGroutLayer");
    changeFloorAndWallGroutImageColor(floorGroutCanvas, currentButton);
}

function changeFloorAndWallGroutImageColor(groutCanvas, currentBtn){
    var currentSelectedGroutColor = currentBtn.style.backgroundColor;
    var currentSelectedGroutColor = currentSelectedGroutColor.substring(4, currentSelectedGroutColor.length-1)
         .replace(/ /g, '')
         .split(',');

    var groutCanvasCtx = groutCanvas.getContext("2d");
    var imgData = groutCanvasCtx.getImageData(0, 0, groutCanvas.width, groutCanvas.height);

    for (var i = 0; i < imgData.data.length; i+= 4)
    {
      if(imgData.data[i+3] > 0)
      {
        imgData.data[i] = currentSelectedGroutColor[0];
        imgData.data[i+1] = currentSelectedGroutColor[1];
        imgData.data[i+2] = currentSelectedGroutColor[2];
        imgData.data[i+3] = 255;
      }
    }

    groutCanvasCtx.putImageData(imgData, 0, 0);
}

function changeFloorMenuHeaderName(headerName) {
    console.log(headerName);
    var header = document.getElementById("floor-grout-menu-header");
    if (header) {
        headerName = headerName.replace('CE40', '');
        headerName = headerName.replace('CE79', '');
        headerName = headerName.replace('CE89', '');
        header.children[0].innerHTML = headerName;
    }
}

function changeWallGrout(currentButton) {
    var roomButtons = document.getElementsByClassName("wall-grout-btn");
    for (i = 0; i < roomButtons.length; i++) {
        roomButtons[i].classList.remove("active");
    }
    currentButton.classList.add('active');

    var floorGroutCanvas = document.getElementById("wallGroutLayer");
    changeFloorAndWallGroutImageColor(floorGroutCanvas, currentButton);
}


function changeWallMenuHeaderName(headerName) {
    console.log(headerName);
    var header = document.getElementById("wall-grout-menu-header");
    if (header) {
        headerName = headerName.replace('CE40', '');
        headerName = headerName.replace('CE79', '');
        headerName = headerName.replace('CE89', '');
        header.children[0].innerHTML = headerName;
    }
}

function changeWallTile(currentButton) {
    var roomButtons = document.getElementsByClassName("wall-tile-btn");
    for (i = 0; i < roomButtons.length; i++) {
        roomButtons[i].classList.remove("active");
    }
    currentButton.classList.add('active');

    var wallTileCanvas = document.getElementById("wallTileLayer");
    var wallTileCanvasCtx = wallTileCanvas.getContext("2d");

    changeFloorAndWallTileImage(wallTileCanvasCtx, currentButton);
}


function changeWallTileMenuHeaderName(headerName) {
    console.log(headerName);
    var header = document.getElementById("wall-tile-menu-header");
    if (header) {
        headerName = headerName.replace('CE40', '');
        headerName = headerName.replace('CE79', '');
        headerName = headerName.replace('CE89', '');
        header.children[0].innerHTML = headerName;
    }
}

function changeFloorTile(room, currentButton) {
    var roomButtons = document.getElementsByClassName("floor-tile-btn");
    for (i = 0; i < roomButtons.length; i++) {
        roomButtons[i].classList.remove("active");
    }
    currentButton.classList.add('active');

    var floorTileCanvas = document.getElementById("floorTileLayer");
    var floorTileCanvasCtx = floorTileCanvas.getContext("2d");

    changeFloorAndWallTileImage(floorTileCanvasCtx, currentButton);
}


function changeFloorTileMenuHeaderName(headerName) {
    console.log(headerName);
    var header = document.getElementById("floor-tile-menu-header");
    if (header) {
        headerName = headerName.replace('CE40', '');
        headerName = headerName.replace('CE79', '');
        headerName = headerName.replace('CE89', '');
        header.children[0].innerHTML = headerName;
    }
}

function changeFloorAndWallTileImage(canvasCtx, currentButton)
{
    var tileName = currentButton.getAttribute("tileName");
    var room = currentButton.getAttribute("roomName");
    console.log("src/img/" + room + "/" + tileName + "_L.png");

    var tileImage = new Image();
    tileImage.onload = function () {
      if (window.innerWidth >= 640) {
        canvasCtx.canvas.width = tileImage.width;
        canvasCtx.canvas.height = tileImage.height;
      } else {
        canvasCtx.canvas.width = tileImage.width;
        canvasCtx.canvas.height = tileImage.height;
      }
      canvasCtx.drawImage(tileImage, 0, 0);
    }
    if (window.innerWidth >= 640) {
      tileImage.src = "src/img/" + room + "/" + tileName + "_L.png"
    } else if (window.innerWidth <= 640) {
      tileImage.src = "src/img/" + room + "/" + tileName + "_P.png"
    }
}